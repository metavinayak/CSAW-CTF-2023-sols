/* This file was generated by the Hex-Rays decompiler version 8.3.0.230608.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 (**init_proc())(void);
void sub_1020();
// int printf(const char *format, ...);
// int puts(const char *s);
// __int64 EVP_MD_CTX_new(void); weak
// int sprintf(char *s, const char *format, ...);
// __int64 __fastcall EVP_DigestUpdate(_QWORD, _QWORD, _QWORD); weak
// __int64 EVP_md5(void); weak
// __int64 __fastcall EVP_MD_CTX_free(_QWORD); weak
// __int64 __isoc99_scanf(const char *, ...); weak
// __int64 __fastcall EVP_DigestInit_ex(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall EVP_DigestFinal_ex(_QWORD, _QWORD, _QWORD); weak
// int __fastcall _cxa_finalize(void *);
void __fastcall __noreturn start(__int64 a1, __int64 a2, void (*a3)(void));
char *deregister_tm_clones();
__int64 register_tm_clones();
char *_do_global_dtors_aux();
__int64 frame_dummy(); // weak
int __fastcall main(int argc, const char **argv, const char **envp);
void term_proc();
// int __fastcall _libc_start_main(int (__fastcall *main)(int, char **, char **), int argc, char **ubp_av, void (*init)(void), void (*fini)(void), void (*rtld_fini)(void), void *stack_end);
// int __fastcall __cxa_finalize(void *);
// __int64 _gmon_start__(void); weak

//-------------------------------------------------------------------------
// Data declarations

void *_dso_handle = &_dso_handle; // idb
char edata; // weak


//----- (0000000000001000) ----------------------------------------------------
__int64 (**init_proc())(void)
{
  __int64 (**result)(void); // rax

  result = &_gmon_start__;
  if ( &_gmon_start__ )
    return (__int64 (**)(void))_gmon_start__();
  return result;
}
// 40D0: using guessed type __int64 _gmon_start__(void);

//----- (0000000000001020) ----------------------------------------------------
void sub_1020()
{
  JUMPOUT(0LL);
}
// 1026: control flows out of bounds to 0

//----- (00000000000010E0) ----------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn start(__int64 a1, __int64 a2, void (*a3)(void))
{
  __int64 v3; // rax
  int v4; // esi
  __int64 v5; // [rsp-8h] [rbp-8h] BYREF
  char *retaddr; // [rsp+0h] [rbp+0h] BYREF

  v4 = v5;
  v5 = v3;
  _libc_start_main((int (__fastcall *)(int, char **, char **))main, v4, &retaddr, 0LL, 0LL, a3, &v5);
  __halt();
}
// 10E6: positive sp value 8 has been found
// 10ED: variable 'v3' is possibly undefined

//----- (0000000000001110) ----------------------------------------------------
char *deregister_tm_clones()
{
  return &edata;
}
// 4060: using guessed type char edata;

//----- (0000000000001140) ----------------------------------------------------
__int64 register_tm_clones()
{
  return 0LL;
}

//----- (0000000000001180) ----------------------------------------------------
char *_do_global_dtors_aux()
{
  char *result; // rax

  if ( !edata )
  {
    if ( &__cxa_finalize )
      _cxa_finalize(_dso_handle);
    result = deregister_tm_clones();
    edata = 1;
  }
  return result;
}
// 4060: using guessed type char edata;

//----- (00000000000011C0) ----------------------------------------------------
__int64 frame_dummy()
{
  return register_tm_clones();
}
// 11C0: using guessed type __int64 frame_dummy();

//----- (00000000000011C9) ----------------------------------------------------
int __fastcall main(int argc, const char **argv, const char **envp)
{
  __int64 v3; // rax
  char v5[44]; // [rsp+0h] [rbp-440h] BYREF
  int v6; // [rsp+2Ch] [rbp-414h] BYREF
  char v7[16]; // [rsp+30h] [rbp-410h] BYREF
  char v8[1008]; // [rsp+40h] [rbp-400h] BYREF
  __int64 v9; // [rsp+430h] [rbp-10h]
  int j; // [rsp+438h] [rbp-8h]
  int i; // [rsp+43Ch] [rbp-4h]

  printf("Enter the String: ");
  __isoc99_scanf("%s", v8);
  for ( i = 0; v8[i]; ++i )
    ;
  if ( i == 12 )
  {
    puts("that's correct!");
    v9 = EVP_MD_CTX_new();
    v3 = EVP_md5();
    EVP_DigestInit_ex(v9, v3, 0LL);
    EVP_DigestUpdate(v9, "12", 2LL);  //csawctf{%s}, %s = hash of "12"
    v6 = 16;
    EVP_DigestFinal_ex(v9, v7, &v6);
    EVP_MD_CTX_free(v9);
    for ( j = 0; j <= 15; ++j )
      sprintf(&v5[2 * j], "%02x", (unsigned __int8)v7[j]);
    printf("csawctf{%s}\n", v5);
  }
  else
  {
    printf("that isn't correct, im sorry!");
  }
  return 0;
}
// 1050: using guessed type __int64 EVP_MD_CTX_new(void);
// 1070: using guessed type __int64 __fastcall EVP_DigestUpdate(_QWORD, _QWORD, _QWORD);
// 1080: using guessed type __int64 EVP_md5(void);
// 1090: using guessed type __int64 __fastcall EVP_MD_CTX_free(_QWORD);
// 10A0: using guessed type __int64 __isoc99_scanf(const char *, ...);
// 10B0: using guessed type __int64 __fastcall EVP_DigestInit_ex(_QWORD, _QWORD, _QWORD);
// 10C0: using guessed type __int64 __fastcall EVP_DigestFinal_ex(_QWORD, _QWORD, _QWORD);
// 11C9: using guessed type char var_400[1008];
// 11C9: using guessed type char var_410[16];
// 11C9: using guessed type char var_440[44];

//----- (000000000000133C) ----------------------------------------------------
void term_proc()
{
  ;
}

// nfuncs=33 queued=9 decompiled=9 lumina nreq=0 worse=0 better=0
// ALL OK, 9 function(s) have been successfully decompiled
